#!/bin/bash

set -e

if [ -z "$1" ]
then
  echo "You need to specify which directory you want to deploy to GitHub Pages"
  exit 1
fi

cp -R $1 .publish
git add .
git commit -m "Deploy to gh-pages"

if [ -n "$(git ls-remote origin gh-pages)" ]
then
  git push origin :gh-pages
fi

git subtree push --prefix .publish origin gh-pages
git reset --hard HEAD^
